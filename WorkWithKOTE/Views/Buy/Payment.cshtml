@{
    ViewBag.Title = "Payment";
}
@model WorkWithKOTE.Models.Trip
@Styles.Render("~/Content/form")
@Styles.Render("~/Content/order")
<script src="//vk.com/js/api/openapi.js" type="text/javascript"></script>
<script src="view-source:http:/connect.facebook.net/en_US/all.js" type="text/javascript"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
<style>
    .payBtn {
        padding: 5px !important;
        border-radius: 4px !important;
        background-color: #ff6f40 !important;
        border: 1px solid #ff6f40 !important;
        color: white !important;
        height: 30px !important;
        cursor: pointer !important;
        margin-top: 10px !important;
        margin-bottom: 10px !important;
        display: inline-block !important;
    }

    input[name=btn_text] {
        margin-bottom: 20px;
        margin-top: 10px;
        cursor: pointer;
        margin-left: 21%;
        width: 172px;
    }

    .infos {
        font-size: 18px;
        margin-top: 6px;
        display: block;
    }

    #orderText {
        font-size: 20px;
        margin-left: -20px;
        text-decoration: underline;
    }

    .container {
        margin-left: 21%;
    }
</style>

@{ Html.RenderPartial("HeaderPartial_main");}

<div id="small-preview-img" class="clearfix">
    <hgroup>
        <h1>Оплата</h1>
        <h2>@Html.ActionLink("Главная", "Index", "Home", null, null) / <span id="currentZ">Оплата</span> </h2>
    </hgroup>
</div>

<div class="container">

    <span id="orderText"> Информация о Вашем туре : </span>

    <div class="infos">Название тура : "@Html.DisplayFor(m => m.Tour.NameTour)"</div>
    <div class="infos">Дата тура : @Html.DisplayFor(m => m.DateTour.FirstDate) - @Html.DisplayFor(m => m.DateTour.SecondDate)</div>
    <div class="infos">Стоимость поездки : @Html.DisplayFor(m => m.Tour.Cost)  @Html.DisplayFor(m => m.Valuta) </div>

    @foreach (var item in Model.SelectedDopUslug)
    {
        <div class="infos">
            @Html.DisplayFor(m => item.SelectedDopUslugName) ( стоимость : @Html.DisplayFor(m => item.SelectedDopPrice) @Html.DisplayFor(m => m.Valuta) )
        </div>
    }
    <div class="infos">Стоимость с учётом дополнительных услуг : <strong> @Html.DisplayFor(m => m.TourPrice)  UAH </strong></div>

    <div id="fb-root">
    </div>
    <div>
        <input type="button" id="share_button" value="Share" />
    </div>
    <input class="payBtn" type="button" value="Изменить информацию" onclick="location.href='@Url.Action("TripEdit", "Buy", new { IdTrip = Model.TripID })'" />
    <input class="payBtn" type="button" value="Вернуться в Профиль" onclick="location.href='@Url.Action("Profile","Profile",null)'" />
</div>

@*<script language="javascript">
        VK.Api.call('photos.getWallUploadServer', {
            uid : parseInt('@ViewBag.UserIDI')
        },function (answer) {
            up_url = answer.response.upload_url; // получаем upload_url, куда загружать фото
            $.post(up_url, // загружаем
            {
                photo : @Model.Tour.TourImg

                },function (request) { // параметры для сохранения

                    request.uid = uid_того_кому_отправляешь;

                    VK.Api.call('photos.saveWallPhoto',{ // сохраняем
                        request// передаем параметры полученные от post + uid_того_кому_отправляешь
                        }, function (result) { // данные о сохраненном фото
                            VK.Api.call('wall.post', { // постим на стену

                                owner_id : result.owner_id,
                                attachments : '<photo><' + result.owner_id + '>_<' + result.id + '>',
                                message : 'фото для тебя '
                            });
                        });
                });
        });

    </script>*@
<script type="text/javascript">
    VK.init({
        apiId: 4747156
    });
    $(document).ready(VK.Api.call('wall.post', { message: "Я КОТЭшествую в @Model.Tour.NameTour. Присоиденяйтесь!! Со мной уже едут  @Model.Tour.People человек ", attachments: "http://localhost:19604/Home/Index" }, function (r) { return r; }));
</script>
<script type="text/javascript">
    window.fbAsyncInit = function () {
        FB.init({
            appId: '336589873199739', status: true, cookie: true,
            xfbml: true
        });
    };
    (function () {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol +
        '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
    }());
</script>
<script type="text/javascript">
    var img = 'http://localhost:19604' + '@Model.Tour.TourImg';
    var TourLink = 'http://localhost:19604/TourDisplay/Index/' + '@Model.TourId';
    $(document).ready(function () {
        $('#share_button').click(function (e) {
            e.preventDefault();
            FB.ui(
{
     method: 'feed',
    name: 'КОТЭшествуй',
    link:  TourLink,
    picture: 'http://kote.travel/UpLoad/TourImg/cab5ca1b-ef57-4566-8cbe-51e0893df6e7.jpg',
    caption: 'Только интересныйе Туры! КОТЭшествуй с нами',
    description: 'Я КОТЭшествую в @Model.Tour.NameTour. Присоиденяйтесь!! Со мной уже едут  @Model.Tour.People человек',
    message: 'Присоединяйтесь!'
});
        });
    });
</script>
<form method="POST" accept-charset="utf-8" action="https://www.liqpay.com/api/checkout">
    <input type="hidden" name="data" value="@ViewBag.Data" />
    <input type="hidden" name="signature" value="@ViewBag.Signature" />
    <input type="image" src="//static.liqpay.com/buttons/p1ru.radius.png" name="btn_text" />
</form>
